import { previewCookieName } from "../constants.js";
import { useSanityConfig, useSanityVisualEditingState } from "../composables/index.js";
import { defineNuxtPlugin, useCookie } from "#imports";
export default defineNuxtPlugin(() => {
  const { visualEditing } = useSanityConfig();
  const visualEditingState = useSanityVisualEditingState();
  if (!visualEditingState) return;
  const { previewMode, previewModeId } = visualEditingState;
  if (previewMode) {
    const previewModeCookie = useCookie(previewCookieName);
    visualEditingState.enabled = previewModeCookie.value === previewModeId;
  } else if (typeof visualEditing === "object" && !previewMode) {
    visualEditingState.enabled = true;
  }
});
